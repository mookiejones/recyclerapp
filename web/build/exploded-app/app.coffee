#
#Load the Google APIs Client Library for JavaScript
#More info here : https://developers.google.com/api-client-library/javascript/reference/referencedocs
# A function that attaches a "Say Hello" button click handler

enableClick = ->

  document.getElementById('helloButton').onclick = ->
    name = document.getElementById('nameInput').value
    gapi.client.myApi.sayHi('name': name).execute (response) ->
      outputAlertDiv = document.getElementById('outputAlert')
      outputAlertDiv.style.visibility = 'visible'
      if !response.error
        outputAlertDiv.className = 'alert alert-success'
        outputAlertDiv.innerHTML = '<h2>' + response.result.data + '</h2>'
      else if response.error
        outputAlertDiv.className = 'alert alert-danger'
        outputAlertDiv.innerHTML = '<b>Error Code: </b>' + response.error.code + ' [' + response.error.message + ']'
      return
    false

  return

# This is called initially

init = ->
  apiName = 'myApi'
  apiVersion = 'v1'
  apiRoot = 'https://' + window.location.host + '/_ah/api'
  if window.location.hostname == 'localhost' or window.location.hostname == '127.0.0.1' or window.location.port != '' and window.location.port > 1023
    # We're probably running against the DevAppServer
    apiRoot = 'http://' + window.location.host + '/_ah/api'

  callback = ->
    enableClick()
    return

  gapi.client.load apiName, apiVersion, callback, apiRoot
  return

# ---
# generated by js2coffee 2.1.0